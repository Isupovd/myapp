<h1 align="center">Средства отказоустойчивости современных операционных систем</h1>
<table align="center" width="85%" border="0" bgcolor="#2F4F4F">
	<tr>
		<td>
			<p>Современные операционные системы до сих пор опираются на архитектурные принципы и решения, заложенные еще в начале своего развития.</p>
			<p>В то время их выбор был обоснован состоянием развития вычислительных машин и их стоимостью, в пользу обеспечения максимальной эффективности и плотности реализации, уменьшения любых накладных вычислительных расходов.</p>
			<p>В настоящее время ситуация значительно изменилась, но по-прежнему используются принципы, которые уже не являются адекватными по отношению к текущему состоянию развития. Прежде всего, речь идет об общем подходе к проектированию и реализации операционных систем в пользу обеспечения надежности и отказоустойчивости. </p>
			<p>В настоящей статье проводится анализ некоторых из современных подходов к повышению отказоустойчивости ОС.</p>
			<p>Использовать подход на основе изоляции драйверов предлагают Свифт и Бершад. Ими была создана прототипная подсистема, получившая название Nooks.</p>
			<p>Nooks – это подсистема монолитного ядра, которая позволяет расширениям ядра, таким как динамические драйверы устройств и драйверы файловых систем, выполняться изолированно в ядре операционной системы.</p>
			<p>В традиционном монолитном ядре любая ошибка в драйвере может повредить важные структуры ядра. Чтобы уменьшить риск последствий ошибок, Nooks позволяет выполнять драйверы в особых областях, для которых устанавливаются ограничения записи в адресном пространстве ядра.</p>
			<p>Nooks отслеживает все попытки доступа или произошедшие сбои, и обеспечивает возможность автоматического восстановления.</p>
			<p>В своем подходе авторы не предлагают разрабатывать новую системную архитектуру, а напротив – улучшить надежность существующих систем, главным образом уменьшив вероятность фатальных сбоев, связанных с системными драйверами.</p>
			<p>Авторами выделяются три ключевых принципа, которым соответствует Nooks.</p>
			<p>Во-первых – совместимость. Архитектура должна быть совместима с существующими системами и расширениями, либо с минимальными изменениями.</p>
			<p>Во-вторых – изоляция сбоев. Архитектура должна строиться таким образом, чтобы изолировать важные структуры ядра от ошибок в системных расширениях и драйверах.</p>
			<p>И, в-третьих – самовосстановление. Архитектура должна поддерживать автоматическое восстановление после сбоев.</p>
			<p>В предлагаемой подсистеме можно выделить несколько ключевых элементов: менеджер изоляции и восстановления.</p>
			<p>Каждый драйвер выполняется в своем собственном контексте исполнения с привилегиями уровня ядра, но с ограниченным доступом записи к определенной части адресного пространства. В задачи менеджера изоляции входят две задачи. Первая – это распределение и учет используемых контекстов исполнения драйверов, а вторая – контроль доступа между контекстами исполнения и сервисами ядра.</p>
			<p>Если происходит сбой в драйвере устройства или другом подконтрольном расширении ядра, подсистема изоляции в состоянии определить источник сбоя до контекста исполнения (который является текущим) и драйвера. Также предусматриваются локализации и мониторинг системных обращений и потребляемых ресурсов.</p>
			<p>При возникновении сбоя и локализации источника происходит остановка текущего контекста выполнения драйвера и начинает работу система самовосстановления, которая состоит из двух частей: менеджера восстановления и агента восстановления.</p>
			<p>Менеджер восстановления выполняет низкоуровневые операции, такие как отключение прерываний для устройства, вызвавшего сбой. Далее вызывается специальный агент восстановления, который реализуется как обычный процесс в пространстве пользователя.</p>
			<p>Агент самовосстановления, согласно определенной политике относительно сбоев в конкретных драйверах, может выполнять специфичные действия по восстановлению и оповещению. Восстановление работоспособности драйвера осуществляется путем полной выгрузки динамического модуля драйвера из ядра и загрузки его заново. </p>
			<p>Для тестирования подсистемы изоляции Nooks в ядре ОС Linux и эмуляции ошибок авторы намеренно внесли ошибки в некоторые драйверы устройств общим количеством 365 изменений. Эффективность подсистемы изоляции составила при этом 99%, 360 из ошибок были изолированы. Однако на системе без подсистемы изоляции драйверов все 365 случаев привели к сбою в системе.</p>
			<p>Накладные расходы, связанные с работой подсистемой изоляции и механизмом восстановления, варьировались от 10% до 60%.</p>
			<p>Системы, построенные на языках, использующих безопасные типы данных</p>
			<p>Следующим развивающимся современным подходом к построению надежных систем является идея использования языков, использующих безопасные типы.</p>
			<p>Использование типо-безопасных языков программирования позволяет избежать некоторых традиционных проблем, связанных с таким языками как Си и Си++. </p>
			<p>Такие языки, как правило, имеют более формальный, несколько ограничивающий диалект, который в частности может запрещать использование указателей на память, оставляя возможность работы с явно выделенными и определенными объектами, доступ к которым осуществляется по ссылкам.</p>
			<p>Одним из важных отличий от традиционных языков является то, что таким языкам необходима специальная среда выполнения.</p>
			<p>Среда выполнения обычно сочетает в себе компилятор, виртуальную машину, менеджер управления памятью и динамической оптимизации, верификатор, различные унифицированные классы языка в привязке к сервисам конкретной операционной системы.</p>
			<p>Использование компилятора, как части общей среды выполнения, нашло широкое применение в современных интерпретируемых языках программирования.</p>
			<p>Одной из возможностей использования встроенного компилятора может заключаться в возможности генерации кода непосредственно вовремя работы среды выполнения.</p>
			<p>Такой подход представляет интерес для возможности динамического создания и изменения структуры кода, или использования мета-рефлексивных процедур[2]. Также одной из важных особенностей интерпретируемых языков является снижение сложности программирования в целом и уменьшение временных затрат на разработку и программирование кода.</p>
			<p>В задачи виртуальной машины входит динамическое выполнение и интерпретирование специальных машинных команд (байткода). Одной из важных задач виртуальной машины является динамическая проверка границ доступа к массивам данных и объектам.</p>
			<p>Особенно важно выделить тот факт, что использование виртуальных машин позволяет легко идентифицировать источники ошибок и создавать подконтрольную среду выполнения, толерантную к сбоям. </p>
			<p>Поэтому использование виртуальных машин и специальных языков сред должно рассматриваться как одно из ключевых направлений в изучении и проектировании отказоустойчивых архитектур.</p>
			<p>Для решения проблемы «утечки памяти» и упрощения процедур управления в современных языках программирования используются так называемые «сборщики мусора», которые освобождают программиста от необходимости освобождать объекты и выполняют управление памятью в автоматическом режиме.</p>
			<p>Очевидно, что такой подход в целом накладывает значительные накладные расходы, по сравнению с выполнением программ на родном машинном языке.</p>
			<p>Для улучшения этой ситуации была создана динамическая JIT (Just-In-Time) компиляция, суть котором заключается в том, что байткод виртуальной машины компилируется в машинные команды родной машины, после чего исполняется как обычная программа.</p>
			<p>Задача верификатора заключается в предварительном, статическом анализе байт-кода виртуальной машины на предмет ошибок и несоответствий по различным эвристическим правилам.</p>
			<p>Также работа верификатора может повысить производительность и упростить работу виртуальной машины, поскольку множество проверок выполняется до исполнения кода и уже не требуется на момент непосредственного выполнения.</p>
			<p>Из систем, построенных на использовании типо-безопасного языка программирования, можно выделить, прежде всего, построенные на языке Java (JavaOS, JNode, JX), и Oberon системах (Bluebottle, Oberon, XO/2), использующих язык Оберон, а также на специальном диалекте языка C#, используемом в новой операционной системе Singularity от компании Microsoft.</p>
			<p>Привлекательной чертой подхода, использующего специальные языки программирования в целом, заключается в том, что появляется очень большая свобода реализации и значительно повышается степень контроля исполнения в сравнении с аппаратной защитой.</p>
			<p>Например, контроль вызовов объектов может осуществляться динамически, таким образом создавая привлекательную и изящную платформу для адекватной реализаций политик информационной безопасности в системе.</p>
			<p>Семантику языка можно расширить, позволяя реализовать множество системных функций простым образом, например, передачу сообщений, создание потоков ядра, синхронизацию, специализированное управление ресурсами, безопасность и другие.</p>
			<p>Также можно повысить стабильность системы, введя средства повышения отказоустойчивости, в частности, транзакционное кэширование критических структур данных, которое хорошо сочетается с персистентным состоянием объектов и с общей идеологией подхода с применением специализированного языка программирования.</p>
			<h4>Подходы к повышению отказоустойчивости операционных систем</h4>
			<p>Можно выделить несколько факторов, способствующих повышению стабильности и надежности операционных систем, которые можно было бы принять во внимание при исследовании и изначальном проектировании архитектуры и системы в целом. </p>
			<p>Во-первых, нужно выделить необходимость использования специального системного типо-безопасного языка программирования, который бы помимо общих, стандартных конструкций поддерживал бы более высокоуровневые механизмы, например, межпроцессные коммуникации, механизмы, повышающие информационную безопасность в целом, контроль выполнения, конструкции, позволяющие изолировать системные сбои. </p>
			<p>Другими словами, свести многие стандартные механизмы и примитивы работы, реализуемые в операционных систем сразу на уровень специализированного системного языка. </p>
			<p>Во-вторых, необходимо кардинально пересмотреть принципы построения системной архитектуры. Проблемы микроядерной архитектуры могут быть частично решены пересмотрением общих, классических принципов организации этой архитектуры. </p>
			<p>В частности, повышение производительности межпроцессных коммуникаций и, следовательно, всей системы в целом может быть осуществлено с помощью отказа от использования множества различных контекстов защиты и помещением всего функционала системы в единое контролируемое пространство. </p>
			<p>Для организации защиты между элементами в системе, вместо аппаратной защиты нужно использовать защиту программную, которая должна реализоваться на уровне системного языка программирования.</p>
			<p>Очевидно, также, что это пространство должно разделяться логически, например, с помощью использования различных пространств имен в системном языке программирования.</p>
			<p>В-третьих, необходимо спроектировать специальные методы, повышающие отказоустойчивость и предоставляющие возможность программным путем производить восстановление после сбоев. Среди подобных методов в общем можно выделить: </p>
			<p>Использование дублирующих объектов, при возникновении сбоев в объекте обработки, этот объект мог бы, прозрачным для системы образом, быть заменен на безопасную версию. </p>
			<p>Использование контрольных точек самовосстановления, возможность использования специальных контрольных точек в которые состояние объекты бы сохранялось. При возникновении сбоев, можно было бы восстановить прошлое состояние объекта.</p>
			<p>Использование различных версий алгоритмов, возможность локального объявления однотипных алгоритмов, если при обработке одного алгоритма случается сбой, управление передавалось бы на другой алгоритм. </p>
			<p>Использование специальных программных доменов отказоустойчивости, или другими словами, возможность объявления иерархических сущностей, которые бы адекватно могли отреагировать на ситуацию сбоя в системе, и предпринять соответствующие действия по восстановлению нормальной работы. </p>
			<p>Очевидно, что все вышеперечисленные средства должны быть также реализованы на уровне системного языка операционной системы. Чтобы добиться описанной функциональности и программного контроля над выполнением такого уровня, для этого должна быть создана специальная среда выполнения языка, выполняющая программный код в специальных контекстах виртуальной машины.</p>
			<p>Другими словами, классическая операционная система должна рассматриваться как среда выполнения для языка программирования этой системы.</p>
			<p>Все вышеизложенные предложения, помимо архитектурных особенностей в целом, способствуют тому, что необходимо исследовать методики программирования и новые языковые сущности для обеспечения отказоустойчивости, локализации и изоляции сбоев.</p>
			<p>Еще очень существенной возможностью является контроль доступа в подобной среде, появляются возможность в принципе контролировать любые обращения и операции между объектами. Таким образом, создавая политики безопасности системы очень высокого уровня, поддерживающие мандатные режимы контроля.</p>
			<p>Что же касательно производительности подобной системы, современные реализации динамической компиляции JIT, позволяют добиться хорошей практически идентичной производительности в сравнении со статической машинной компиляцией.</p>
		</td>
	</tr>
</table>